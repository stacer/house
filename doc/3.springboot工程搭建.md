[[toc]]
#	第三章：工程搭建
##	创建SpringBoot工程
1.安装STS插件
2.创建Springboo工程,输入`group:com.mooc.house`,`artifactid:house`,选择web和freemarker依赖

##	将内嵌的tomcat换成netty(可插拔容器)
### 移除`spring-boot-starter-web`，引入`spring-boot-starter-jetty`
### 创建`com.mooc.house.fiter`和`LogFilter`，目的是为了在请求过来的时候打印日志
### 在同级`com.mooc.house.fiter`目录下创建`FilterBeanConfig`，将自己创建的Filter利用Spring的`FilterRegistrationBean`包装,并设置拦截规则
### 验证,启动容器。并在浏览器中访问，注意观察控制台，会发现我们编写的日志在控制台中打印出来

##	数据访问层搭建-整合mybatis
### 引入`mybatis-starter`和mysql驱动
### 在application.properties中配置数据源和mybatis
### 编写`mybatis-config.xml`
#### 配置`<settings>`标签
##### 配置关闭缓存
##### 配置开启驼峰转下划线
##### 配置生成`useGeneratedKeys`
##### 配置`defaultExecutorType`，设置为`REUSE`，好处是可以缓存`preparedStatement`，提高性能
##### 配置事务执行的超时时间`defaultStatementTimeout`
#### 配置mapper路径
#### 配置别名包(这里是User)

### 创建resources/mapper包及UserMapper.xml
### 创建domain包和User实体类
### 编写UserMapper.xml
### 创建mapper包及UserMapper接口(记得加上`@Mapper注解`)
### 创建controller包和UserController方便在浏览器中测试
### 测试
![](https://ws1.sinaimg.cn/large/006pwLrvgy1fqi7w05eoej30p60drtg5.jpg)
启动报错了,找了很久都不知道到底哪里出错。后来发现是在`application.properties`的mysql驱动值后面加了一个空格！！！
![](https://ws1.sinaimg.cn/large/006pwLrvgy1fqi7xq9z2nj30fs03agm4.jpg)
修改之后,再次启动测试:
![](https://ws1.sinaimg.cn/large/006pwLrvgy1fqi8od2zxpj30yt0ly406.jpg)

##	整合Druid连接池
我们之前没有配置连接池,springboot会为我们自动配置一个tomcat的连接池`tomcat-jdbc`

###	引入Druid连接池
1.pom.xml中加入依赖

2.创建config包,并创建DruidConfig类,标记为`@Configuration`
1. 配置DruidDataSource
2. 配置statFilter
3. pom.xml中引入guava
4. 为`@Bean`的DataSource再添加`@ConfigurationProperties(prefix="spring.druid")`，这么做是为了与配置文件中的属性信息进行绑定
5. 添加监控`ServletRegistrationBean`，之前自定义的`Filter`是通过`FilterRegistrationBean`封装,这里是`servlet`,所以与其相似的,就要通过`ServletRegistrationBean`封装，并指定一下拦截的url(`druid/**`)

3.application.properties中配置druid的属性
4.启动项目,打开浏览器测试
![](http://ww1.sinaimg.cn/large/006pwLrvgy1fqiea6x5bej30z40h4q53.jpg)






